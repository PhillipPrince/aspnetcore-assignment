@model List<ServiceTypeModel>

<form method="post" action="/Queue/ProcessSelection">
    <div class="container">
        <main role="main" class="pb-3">
            <div class="form-group">
                <label for="customerName">Enter Your Name:</label>
                <input type="text" class="form-control" id="customerName" name="customerName" placeholder="Your Name" required>
            </div>

            <!-- Include a hidden input field to store the selected service ID -->
            <input type="hidden" id="selectedServiceId" name="selectedServiceId" value="" />

            <h1>Select Your Service</h1>
            <!-- Service Selection using Buttons -->
            <div class="row">
                @foreach (var service in Model)
                {
                    <div class="col-md-4 mb-3">
                        <!-- Update the button to set the selected service ID -->
                        <button type="button" class="btn btn-primary btn-lg btn-block service-button"
                                data-service-id="@service.Id" onclick="handleButtonClick('@service.Id', '@service.Name')">
                            @service.Name
                        </button>
                    </div>
                }
            </div>

        </main>
    </div>
</form>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // Handle button click event
    function handleButtonClick(serviceId, serviceName) {
        var customerName = $("#customerName").val(); // Get customer name from the input field

        // Prepare data for the AJAX request
        var requestData = {
            selectedServiceId: serviceId,
            customerName: customerName
        };

        // Make an AJAX POST request to the server-side action
        $.ajax({
            url: '/Queue/ProcessSelection',
            type: 'POST',
            data: requestData,
            success: function (response) {
                // Handle the success response (if needed)
                console.log("Request successful:", response);

                // Redirect to the waiting page
                window.location.href = '/Queue/WaitingPage?serviceId=' + serviceId;
            },
            error: function (xhr, status, error) {
                // Handle any errors from the server
                console.error("Request error:", error);
                // Optionally, display an error message or take corrective actions
            }
        });
    }
</script>

